面试官你好，我叫计冉

2016年毕业于淮北师范大学 通信工程专业

目前有3份工作经验

1、 2016年10月-2017年7月 在北京清奇科技有限公司  任职Java开发工程师岗位

所作的项目是微光APP  

一款陌生人兴趣社交软件，主要功能是两个或多个用户可以在一个房间里一起看电影和聊天

我主要负责其中聊天室功能、视频管理

我所写的功能供5百万用户稳定使用



从这个项目的开发过程中让我对Java技术栈有一个比较全面的认识同时了解了企业级项目开发流程



2、2017.08–2021.04 在安徽好马科技有限公司  任职Java开发工程师

后来架构师走后，由我任后端开发组长



 所做的项目是小马出行APP 网约车打车系统 分为乘客端和司机端，主要在合肥，成都、武汉等城市运营

开始的开发任务中主要负责打车模块、订单模块以及项目性能优化功能

后来架构师走后，我任后端组长，主要负责需求分析，项目进度管理和架构设计



在我任开发组长的时候，和团队一起对2个系统重构，按照功能模块拆分为多个子服务，使用SpringCloud实现微服务化

1、提高了系统响应速度

2、各个子系统职责明确，便于后续维护



在小马出行项目中主要学到了俩点

1、经历了一个系统完整的重构过程，包括技术选型，业务拆分和团队协作

2、首次接触了项目管理，学习了技术之外的东西，对团队管理有点经验





3、 2021.04 – 至今 在科大讯飞股份有限公司 任职Java开发工程师岗位

所作的项目是智慧体育，

针对学生体育测试以及体育考试场景，基于视觉识别的在线测评系统，

产品形态分为pad端和web端，

可以实现跳绳、跳远、引体向上等项目的在线测评并实时出成绩，同时结合关键指标给出运动建议等功能



我主要负责测评系统中报告模块业务代码开发

和通用组件的详细设计和开发 包括统计模块、流程模块

在这期间获得最佳新员工和突出进步奖



1、学习了同事比较优秀的代码设计，通过互相代码评审，可以发现自己的问题和学习别人的代码思想

2、学习到了产品思维，以前都是产品提需求，我负责实现，很少从一个用户的角度去思考合不合理。但是在讯飞比较强调产品是团队一起设计出来了，评审时每个人都可以把自己当成用户，提出问题优化产品



派单服务、订单服务、支付服务、用户服务、定时任务服务、会员服务等



拆分后不久，偶尔会接口日志报警，显示接口请求耗时5秒以上

查看JVM监控日志，经常发现FuuGC，清理系统垃圾，猜测可能这个导致变慢，

JDK7升级JDK8，默认20MB，加载了的元数据信息，512MB

好了点，接口超时的频率降了，还是有一些，但是看JVM日志，基本是正常的，没有特别长时间的GC，

查看了下数据库，发现活动时候，Druid 连接池，用户多会导致数据库线程满了，查询会变慢

发现是我们微服务后，把一个项目拆分为多个项目，每个小的服务和数据库都保持线程池连接，导致很多多余的线程浪费，我们将数据库连接的服务独立出来，拆分几个服务专门用户数据库查询，减少数据库连接



可以看到，有次 GC 耗费的时间接近两秒，应用的停顿时间也接近两秒，而且此次的垃圾回收是 ParNew 算法，也就是发生在新生代。所以基本可以确定，**是垃圾回收的停顿导致应用不可用，进而导致接口超时**。



不得已，开始求助网友，上 stackoverflow 发帖（链接见文末），有大神从 GC log 发现，有两次 GC 回收的对象大小几乎一样，但是耗时却相差十倍，因此建议确认下系统的 CPU 情况，是否是虚拟环境，可能存在激烈的 CPU 资源竞争。

其实之前已经怀疑是 CPU 资源问题，通过监控平台发现，垃圾回收时 CPU 波动并不大。

但运维发现我们应用的垃圾回收线程数有些问题（GC 线程数可以通过 jstack 命令打印线程堆栈查看），JVM 的 GC 线程数量是根据 CPU 的核数确定的，如果是八个核心以下，GC 线程数等于CPU 核心数，我们应用跑在 docker 容器，分配的核心是六核，但是新生代 GC 线程数却达到了 53个，这明显不正常。

最后发现，这个问题是 JVM 在 docker 环境中，获取到的 CPU 信息是宿主机的（容器中 /proc目录并未做隔离，各容器共享，CPU信息保存在该目录下），并不是指定的六核心，宿主机是八十核心，因此创建的垃圾回收线程数远大于 docker 环境的 CPU 资源，导致每次新生代回收线程间竞争激烈，耗时增加。

通过指定 JVM 垃圾回收线程数为 CPU 核心数，限制新生代垃圾回收线程，增加JVM参数



新生代垃圾回收时间基本降到 50 毫秒以下，成功解决垃圾回收耗时较长问题。





